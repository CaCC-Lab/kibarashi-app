// CLAUDE-GENERATED: フォールバック提案データ
// Gemini APIが利用できない場合の代替提案

const fallbackSuggestions = {
  workplace: {
    5: [
      {
        id: 'fallback-wp-5-1',
        title: '深呼吸で気持ちをリセット',
        description: '4-7-8呼吸法で心を落ち着かせます',
        duration: 5,
        category: '認知的',
        steps: [
          '椅子に座り、背筋を伸ばす',
          '鼻から4秒かけて息を吸う',
          '7秒間息を止める',
          '口から8秒かけて息を吐く',
          'これを3-4回繰り返す'
        ]
      },
      {
        id: 'fallback-wp-5-2',
        title: 'デスク周りの軽いストレッチ',
        description: '座ったままできる簡単ストレッチ',
        duration: 5,
        category: '行動的',
        steps: [
          '肩を上げて3秒キープ、ゆっくり下ろす',
          '首を左右にゆっくり回す',
          '手首をくるくる回す',
          '足首を回して血行促進',
          '最後に背伸びをする'
        ]
      },
      {
        id: 'fallback-wp-5-3',
        title: '感謝のメンタルリスト',
        description: '今日の良かったことを3つ思い出す',
        duration: 5,
        category: '認知的',
        steps: [
          '目を閉じて今日を振り返る',
          '小さくても良かったことを1つ思い出す',
          '2つ目の良かったことを見つける',
          '3つ目を探してみる',
          'それぞれに感謝の気持ちを感じる'
        ]
      },
      {
        id: 'fallback-wp-5-4',
        title: '5分間の瞑想',
        description: '心を静めてリラックス',
        duration: 5,
        category: '認知的',
        steps: [
          '姿勢を正して座る',
          '目を閉じて呼吸に集中',
          '雑念が浮かんでも気にしない',
          '呼吸の音に意識を向ける',
          'ゆっくりと目を開ける'
        ]
      },
      {
        id: 'fallback-wp-5-5',
        title: '机の整理整頓',
        description: 'デスクを片付けて気分すっきり',
        duration: 5,
        category: '行動的',
        steps: [
          '不要な書類を捨てる',
          '文房具を整理する',
          '画面を清拭する',
          '引き出しを整理する',
          '清潔なデスクを眺める'
        ]
      },
      {
        id: 'fallback-wp-5-6',
        title: '好きな写真を見る',
        description: '心温まる写真で気分転換',
        duration: 5,
        category: '認知的',
        steps: [
          'スマホの写真フォルダを開く',
          '家族やペットの写真を見る',
          '楽しい思い出を思い出す',
          '写真の中の人に感謝する',
          '笑顔になる'
        ]
      }
    ],
    15: [
      {
        id: 'fallback-wp-15-1',
        title: '軽い散歩でリフレッシュ',
        description: 'オフィス内や建物周辺を歩く',
        duration: 15,
        category: '行動的',
        steps: [
          'デスクから立ち上がる',
          '階段の上り下りを2-3回',
          '外の空気を吸いに出る',
          '遠くの景色を眺める',
          'ゆっくりと職場に戻る'
        ]
      },
      {
        id: 'fallback-wp-15-2',
        title: 'マインドフルネス瞑想',
        description: '今この瞬間に意識を向ける',
        duration: 15,
        category: '認知的',
        steps: [
          '静かな場所を見つける',
          '楽な姿勢で座る',
          '呼吸に意識を向ける',
          '雑念が浮かんでも呼吸に戻る',
          'ゆっくりと目を開ける'
        ]
      },
      {
        id: 'fallback-wp-15-3',
        title: '同僚とのティーブレイク',
        description: '気軽な会話でストレス解消',
        duration: 15,
        category: '行動的',
        steps: [
          '信頼できる同僚を誘う',
          '休憩スペースへ移動',
          '温かい飲み物を用意',
          '仕事以外の話題で会話',
          'お互いの話を聞き合う'
        ]
      }
    ],
    30: [
      {
        id: 'fallback-wp-30-1',
        title: '本格的なウォーキング',
        description: '外の空気を吸いながら歩く',
        duration: 30,
        category: '行動的',
        steps: [
          '歩きやすい服装に着替える',
          '近くの公園や遊歩道へ',
          '自分のペースで歩く',
          '自然や景色を楽しむ',
          '深呼吸しながら職場へ戻る'
        ]
      }
    ]
  },
  home: {
    5: [
      {
        id: 'fallback-hm-5-1',
        title: '温かいお茶でひと息',
        description: '好きな飲み物でリラックス',
        duration: 5,
        category: '行動的',
        steps: [
          'お気に入りの飲み物を用意',
          '静かな場所に座る',
          '香りを楽しむ',
          'ゆっくりと味わう',
          '心が落ち着くのを感じる'
        ]
      },
      {
        id: 'fallback-hm-5-2',
        title: 'ペットや植物との交流',
        description: '生き物との触れ合いで癒される',
        duration: 5,
        category: '行動的',
        steps: [
          'ペットに優しく話しかける',
          '撫でたり遊んだりする',
          '植物があれば水やりや手入れ',
          '成長や変化を観察',
          '命のぬくもりを感じる'
        ]
      },
      {
        id: 'fallback-hm-5-3',
        title: '好きな音楽を1曲',
        description: 'お気に入りの曲で気分転換',
        duration: 5,
        category: '認知的',
        steps: [
          '今の気分に合う曲を選ぶ',
          'ヘッドホンで聴く準備',
          '目を閉じて再生',
          '歌詞やメロディに集中',
          '曲の余韻を楽しむ'
        ]
      }
    ]
  },
  outside: {
    5: [
      {
        id: 'fallback-out-5-1',
        title: '周囲の観察ゲーム',
        description: '五感を使って環境を観察',
        duration: 5,
        category: '認知的',
        steps: [
          '安全な場所で立ち止まる',
          '見えるものを5つ数える',
          '聞こえる音を4つ見つける',
          '触れるものを3つ感じる',
          '香りや味を2つ意識する'
        ]
      },
      {
        id: 'fallback-out-5-2',
        title: '公園のベンチで休憩',
        description: '自然の中でリラックス',
        duration: 5,
        category: '行動的',
        steps: [
          '近くのベンチを見つける',
          'ゆったりと座る',
          '空や木々を眺める',
          '鳥の声に耳を傾ける',
          '深呼吸を数回する'
        ]
      },
      {
        id: 'fallback-out-5-3',
        title: 'スマホで友人にメッセージ',
        description: '大切な人とつながる',
        duration: 5,
        category: '行動的',
        steps: [
          '連絡したい人を思い浮かべる',
          '簡単な挨拶メッセージを作成',
          '近況や感謝を伝える',
          '送信して返事を待つ',
          'つながりを感じる'
        ]
      }
    ]
  }
};

// 就活・転職活動者向けの追加提案
const jobHuntingFallback = {
  job_hunting: {
    5: [
      {
        id: 'fallback-jh-5-1',
        title: '面接前の呼吸法',
        description: '緊張を和らげる特別な呼吸',
        duration: 5,
        category: '認知的',
        steps: [
          '静かな場所で立つか座る',
          '鼻から4秒吸って腹を膨らませる',
          '4秒息を止める',
          '口から4秒吐いて腹をへこませる',
          '「大丈夫」と心の中で唱える'
        ]
      },
      {
        id: 'fallback-jh-5-2',
        title: 'ポジティブアファメーション',
        description: '自己肯定感を高める言葉かけ',
        duration: 5,
        category: '認知的',
        steps: [
          '鏡の前に立つか、スマホのカメラを見る',
          '「私には価値がある」と3回言う',
          '「私は成長している」と3回言う',
          '「私は最善を尽くしている」と3回言う',
          '自分に微笑みかける'
        ]
      },
      {
        id: 'fallback-jh-5-3',
        title: '小さな達成リスト',
        description: '今日できたことを認める',
        duration: 5,
        category: '認知的',
        steps: [
          'メモアプリを開く',
          '今日できたことを1つ書く（起床でもOK）',
          '2つ目を追加（朝食を食べた等）',
          '3つ目を追加（履歴書を1行書いた等）',
          '自分を褒める'
        ]
      }
    ]
  }
};

function getFallbackSuggestions(situation, duration, ageGroup) {
  // 就活・転職活動者向けの特別対応
  if (ageGroup === 'job_hunting' || situation === 'job_hunting') {
    const suggestions = jobHuntingFallback.job_hunting[duration] || 
                      jobHuntingFallback.job_hunting[5];
    return shuffleArray(suggestions).slice(0, 3);
  }
  
  // 通常の提案
  const situationData = fallbackSuggestions[situation] || fallbackSuggestions.workplace;
  const durationData = situationData[duration] || situationData[5];
  
  // 毎回異なる3つをランダムに返す
  return shuffleArray(durationData).slice(0, 3);
}

// 配列をシャッフルする関数
function shuffleArray(array) {
  const shuffled = [...array];
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  return shuffled;
}

module.exports = { getFallbackSuggestions };